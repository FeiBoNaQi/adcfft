/* USER CODE BEGIN Header */
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  * @attention
  *
  * <h2><center>&copy; Copyright (c) 2021 STMicroelectronics.
  * All rights reserved.</center></h2>
  *
  * This software component is licensed by ST under BSD 3-Clause license,
  * the "License"; You may not use this file except in compliance with the
  * License. You may obtain a copy of the License at:
  *                        opensource.org/licenses/BSD-3-Clause
  *
  ******************************************************************************
  */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "adc.h"
#include "dfsdm.h"
#include "dma.h"
#include "i2c.h"
#include "quadspi.h"
#include "spi.h"
#include "tim.h"
#include "usart.h"
#include "usb_otg.h"
#include "gpio.h"
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include <string.h>
#include <stdio.h>
#include <math.h>
/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */
#define ADC_BUF_LEN 2048
/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */

/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/

/* USER CODE BEGIN PV */
double phase1_585;
double phase1_586;
double phase2_585;
double phase2_586;
int adc_conv_flag=0;
uint16_t adc1_buf[ADC_BUF_LEN];
uint16_t adc2_buf[ADC_BUF_LEN];
const static double fft_ratio_585_R[1024]={1,-0.901348847046009,0.624859488142369,-0.225083911359784,-0.219101240156856,0.620057211763243,-0.898674465693875,0.999981175282500,-0.903989293123340,0.629638238914848,-0.231058108280641,-0.213110319916053,0.615231590580517,-0.895966249756015,0.999924701838942,-0.906595704514721,0.634393284163503,-0.237023605994315,-0.207111376192158,0.610382806276136,-0.893224301195254,0.999830581795520,-0.909167983090237,0.639124444863570,-0.242980179903188,-0.201104634842010,0.605511041404090,-0.890448723244405,0.999698818695799,-0.911706032005052,0.643831542889521,-0.248927605745620,-0.195090322016026,0.600616479383572,-0.887639620402412,0.999529417500587,-0.914209755703060,0.648514401021776,-0.254865659604389,-0.189068664149685,0.595699304492077,-0.884797098430406,0.999322384587742,-0.916679059920479,0.653172842953374,-0.260794117915122,-0.183039887955002,0.590759701858458,-0.881921264347734,0.999077727751936,-0.919113851689401,0.657806693296608,-0.266712757474717,-0.177004220411993,0.585797857455965,-0.879012226427924,0.998795456204362,-0.921514039341291,0.662415777589633,-0.272621355449738,-0.170961888760130,0.580813958095233,-0.876070094194610,0.998475580572384,-0.923879532510441,0.666999922303029,-0.278519689384811,-0.164913120489785,0.575808191417258,-0.873094978417406,0.998118112899137,-0.926210242137370,0.671558954846339,-0.284407537210998,-0.158858143333664,0.570780745886325,-0.870086991107741,0.997723066643079,-0.928506080472179,0.676092703574566,-0.290284677254156,-0.152797185258234,0.565731810782917,-0.867046245514636,0.997290456677476,-0.930766961077852,0.680600997794631,-0.296150888243283,-0.146730474455142,0.560661576196586,-0.863972856120445,0.996820299289851,-0.932992798833510,0.685083667771805,-0.302005949318852,-0.140658239332620,0.555570233018801,-0.860866938636541,0.996312612181363,-0.935183509937622,0.689540544736097,-0.307849640041122,-0.134580708506889,0.550457972935752,-0.857728609998962,0.995767414466144,-0.937339011911152,0.693971460888609,-0.313681740398441,-0.128498110793549,0.545324988421144,-0.854557988364007,0.995184726670581,-0.939459223600669,0.698376249407853,-0.319502030815526,-0.122410675198967,0.540171472728942,-0.851355193103789,0.994564570732539,-0.941544065181402,0.702754744456028,-0.325310292161733,-0.116318630911651,0.534997619886098,-0.848120344801739,0.993906970000540,-0.943593458160243,0.707106781185273,-0.331106305759305,-0.110222207293627,0.529803624685249,-0.844853565248068,0.993211949232879,-0.945607325378706,0.711432195743864,-0.336889853391606,-0.104121633871796,0.524589682677377,-0.841554977435178,0.992479534596694,-0.947585591015826,0.715730825282387,-0.342660717311337,-0.0980171403293019,0.519355990164453,-0.838224705553038,0.991709753666984,-0.949528180591022,0.720002507959870,-0.348418680248732,-0.0919089564968748,0.514102744192042,-0.834862874984501,0.990902635425565,-0.951435020966894,0.724247082949874,-0.354163525419742,-0.0857973123441839,0.508830142541885,-0.831469612300588,0.990058210259983,-0.953306040351979,0.728464390446550,-0.359895036534193,-0.0796824379711774,0.503538383724454,-0.828045045255720,0.989176509962368,-0.955141168303456,0.732654271670656,-0.365612997803930,-0.0735645635994192,0.498227666971478,-0.824589302782913,0.988257567728238,-0.956940335729793,0.736816568875529,-0.371317193950945,-0.0674439195634215,0.492898192228441,-0.821102514988916,0.987301418155249,-0.958703474893354,0.740951125353035,-0.377007410215475,-0.0613207363019730,0.487550160147055,-0.817584813149320,0.986308097241891,-0.960430519412947,0.745057785439457,-0.382683432364095,-0.0551952443494626,0.482183772077705,-0.814036329703610,0.985277642386136,-0.962121404266321,0.749136394521364,-0.388345046697779,-0.0490676743272001,0.476799230061869,-0.810457198250182,0.984210092384026,-0.963776065792617,0.753186799041431,-0.393992040059947,-0.0429382569347336,0.471396736824510,-0.806847553541314,0.983105487428216,-0.965394441694765,0.757208846504216,-0.399624199844490,-0.0368072229411635,0.465976495766445,-0.803207531478087,0.981963869106458,-0.966976471041825,0.761202385481905,-0.405241314003777,-0.0306748031764545,0.460538710956687,-0.799537269105276,0.980785280400037,-0.968522094271287,0.765167265620014,-0.410843171056634,-0.0245412285227446,0.455083587124759,-0.795836904606184,0.979569765682151,-0.970031253191311,0.769103337643045,-0.416429560096309,-0.0184067299056529,0.449611329652992,-0.792106577297443,0.978317370716242,-0.971503890982916,0.773010453360112,-0.422000270798412,-0.0122715382855849,0.444122144568786,-0.788346427623768,0.977028142654273,-0.972939952202121,0.776888465670517,-0.427555093428834,-0.00613588464903763,0.438616238536856,-0.784556597152668,0.975702130034952,-0.974339382782033,0.780737228569287,-0.433093818851642,9.74220704104974e-14,0.433093818851454,-0.780737228569120,0.974339382781904,-0.975702130034882,0.784556597152676,-0.438616238536955,0.00613588464923117,0.427555093428559,-0.776888465670192,0.972939952201794,-0.977028142654004,0.788346427623614,-0.444122144568793,0.0122715382857748,0.422000270798052,-0.773010453359631,0.971503890982392,-0.978317370715773,0.792106577297126,-0.449611329652906,0.0184067299058366,0.416429560095867,-0.769103337642409,0.970031253190590,-0.979569765681481,0.795836904605703,-0.455083587124577,0.0245412285229195,0.410843171056112,-0.765167265619224,0.968522094270371,-0.980785280399167,0.799537269104630,-0.460538710956407,0.0306748031766182,0.405241314003177,-0.761202385480964,0.966976471040713,-0.981963869105387,0.803207531477274,-0.465976495766065,0.0368072229413136,0.399624199843815,-0.757208846503125,0.965394441693457,-0.983105487426944,0.806847553540332,-0.471396736824027,0.0429382569348674,0.393992040059198,-0.753186799040192,0.963776065791116,-0.984210092382552,0.810457198249031,-0.476799230061282,0.0490676743273154,0.388345046696959,-0.749136394519978,0.962121404264626,-0.985277642384459,0.814036329702287,-0.482183772077011,0.0551952443495566,0.382683432363206,-0.745057785437926,0.960430519411059,-0.986308097240012,0.817584813147824,-0.487550160146253,0.0613207363020434,0.377007410214520,-0.740951125351361,0.958703474891275,-0.987301418153167,0.821102514987246,-0.492898192227528,0.0674439195634657,0.371317193949926,-0.736816568873714,0.956940335727522,-0.988257567725953,0.824589302781068,-0.498227666970451,0.0735645635994348,0.365612997802850,-0.732654271668701,0.955141168300994,-0.989176509959879,0.828045045253698,-0.503538383723312,0.0796824379711618,0.359895036533053,-0.728464390444458,0.953306040349329,-0.990058210257291,0.831469612298387,-0.508830142540625,0.0857973123441348,0.354163525418546,-0.724247082947645,0.951435020964055,-0.990902635422668,0.834862874982121,-0.514102744190663,0.0919089564967898,0.348418680247481,-0.720002507957506,0.949528180587995,-0.991709753663883,0.838224705550478,-0.519355990162953,0.0980171403291784,0.342660717310034,-0.715730825279891,0.947585591012612,-0.992479534593388,0.841554977432436,-0.524589682675753,0.104121633871632,0.336889853390253,-0.711432195741237,0.945607325375305,-0.993211949229368,0.844853565245142,-0.529803624683499,0.110222207293419,0.331106305757905,-0.707106781182518,0.943593458156658,-0.993906969996824,0.848120344798629,-0.534997619884220,0.116318630911397,0.325310292160288,-0.702754744453146,0.941544065177633,-0.994564570728619,0.851355193100493,-0.540171472726934,0.122410675198665,0.319502030814038,-0.698376249404845,0.939459223596717,-0.995184726666455,0.854557988360524,-0.545324988419005,0.128498110793197,0.313681740396913,-0.693971460885479,0.937339011907018,-0.995767414461813,0.857728609995291,-0.550457972933479,0.134580708506483,0.307849640039556,-0.689540544732845,0.935183509933307,-0.996312612176827,0.860866938632681,-0.555570233016392,0.140658239332158,0.302005949317251,-0.685083667768433,0.932992798829015,-0.996820299285110,0.863972856116395,-0.560661576194040,0.146730474454622,0.296150888241649,-0.680600997791142,0.930766961073177,-0.997290456672530,0.867046245510395,-0.565731810780230,0.152797185257653,0.290284677252492,-0.676092703570961,0.928506080467327,-0.997723066637926,0.870086991103307,-0.570780745883497,0.158858143333020,0.284407537209306,-0.671558954842621,0.926210242132341,-0.998118112893780,0.873094978412779,-0.575808191414286,0.164913120489076,0.278519689383094,-0.666999922299199,0.923879532505236,-0.998475580566821,0.876070094189788,-0.580813958092116,0.170961888759353,0.272621355447997,-0.662415777585693,0.921514039335911,-0.998795456198594,0.879012226422907,-0.585797857452700,0.177004220411146,0.266712757472956,-0.657806693292561,0.919113851683848,-0.999077727745964,0.881921264342521,-0.590759701855044,0.183039887954082,0.260794117913343,-0.653172842949222,0.916679059914754,-0.999322384581564,0.884797098424995,-0.595699304488512,0.189068664148690,0.254865659602593,-0.648514401017520,0.914209755697164,-0.999529417494204,0.887639620396802,-0.600616479379854,0.195090322014953,0.248927605743811,-0.643831542885163,0.911706031998986,-0.999698818689212,0.890448723238597,-0.605511041400217,0.201104634840857,0.242980179901369,-0.639124444859113,0.909167983084002,-0.999830581788728,0.893224301189245,-0.610382806272107,0.207111376190923,0.237023605992487,-0.634393284158949,0.906595704508320,-0.999924701831946,0.895966249749804,-0.615231590576329,0.213110319914734,0.231058108278808,-0.629638238910198,0.903989293116773,-0.999981175275300,0.898674465687462,-0.620057211758895,0.219101240155449,0.225083911357947,-0.624859488137627,0.901348847039277,-0.999999999992596,0.901348847039420,-0.624859488137895,0.225083911358307,0.219101240155043,-0.620057211758499,0.898674465687136,-0.999981175275095,0.903989293116730,-0.629638238910337,0.231058108279120,0.213110319914285,-0.615231590575808,0.895966249749294,-0.999924701831536,0.906595704508091,-0.634393284158957,0.237023605992750,0.207111376190434,-0.610382806271462,0.893224301188552,-0.999830581788113,0.909167983083586,-0.639124444858988,0.242980179901578,0.201104634840330,-0.605511041399452,0.890448723237724,-0.999698818688392,0.911706031998382,-0.643831542884903,0.248927605743966,0.195090322014390,-0.600616479378969,0.887639620395750,-0.999529417493180,0.914209755696370,-0.648514401017123,0.254865659602690,0.189068664148094,-0.595699304487509,0.884797098423764,-0.999322384580336,0.916679059913770,-0.653172842948685,0.260794117913380,0.183039887953455,-0.590759701853927,0.881921264341113,-0.999077727744531,0.919113851682672,-0.657806693291884,0.266712757472930,0.177004220410491,-0.585797857451470,0.879012226421323,-0.998795456196958,0.921514039334543,-0.662415777584874,0.272621355447907,0.170961888758673,-0.580813958090774,0.876070094188029,-0.998475580564980,0.923879532503675,-0.666999922298236,0.278519689382936,0.164913120488372,-0.575808191412835,0.873094978410847,-0.998118112891735,0.926210242130586,-0.671558954841512,0.284407537209079,0.158858143332295,-0.570780745881939,0.870086991101203,-0.997723066635678,0.928506080465377,-0.676092703569703,0.290284677252193,0.152797185256910,-0.565731810778567,0.867046245508120,-0.997290456670078,0.930766961071031,-0.680600997789734,0.296150888241276,0.146730474453863,-0.560661576192274,0.863972856113950,-0.996820299282455,0.932992798826672,-0.685083667766874,0.302005949316801,0.140658239331386,-0.555570233014525,0.860866938630068,-0.996312612173969,0.935183509930767,-0.689540544731133,0.307849640039028,0.134580708505700,-0.550457972931514,0.857728609992511,-0.995767414458754,0.937339011904280,-0.693971460883612,0.313681740396303,0.128498110792405,-0.545324988416943,0.854557988357578,-0.995184726663193,0.939459223593780,-0.698376249402821,0.319502030813345,0.122410675197867,-0.540171472724778,0.851355193097383,-0.994564570725155,0.941544065174497,-0.702754744450964,0.325310292159508,0.116318630910597,-0.534997619881972,0.848120344795356,-0.993906969993160,0.943593458153322,-0.707106781180175,0.331106305757037,0.110222207292617,-0.529803624681161,0.844853565241708,-0.993211949225502,0.945607325371768,-0.711432195738733,0.336889853389295,0.104121633870832,-0.524589682673327,0.841554977428842,-0.992479534589322,0.947585591008873,-0.715730825277223,0.342660717308983,0.0980171403283823,-0.519355990160442,0.838224705546726,-0.991709753659616,0.949528180584053,-0.720002507954674,0.348418680246335,0.0919089564960003,-0.514102744188069,0.834862874978212,-0.990902635418203,0.951435020959909,-0.724247082944646,0.354163525417302,0.0857973123433546,-0.508830142537950,0.831469612294323,-0.990058210252625,0.953306040344980,-0.728464390441290,0.359895036531710,0.0796824379703932,-0.503538383720558,0.828045045249480,-0.989176509955016,0.955141168296441,-0.732654271665364,0.365612997801405,0.0735645635986802,-0.498227666967620,0.824589302776697,-0.988257567720891,0.956940335722764,-0.736816568870205,0.371317193948376,0.0674439195627277,-0.492898192224622,0.821102514982726,-0.987301418147908,0.958703474886311,-0.740951125347680,0.377007410212864,0.0613207363013245,-0.487550160143275,0.817584813143154,-0.986308097234557,0.960430519405890,-0.745057785434070,0.382683432361441,0.0551952443488593,-0.482183772073964,0.814036329697469,-0.985277642378808,0.962121404259251,-0.749136394515947,0.388345046695083,0.0490676743266422,-0.476799230058167,0.810457198244067,-0.984210092376705,0.963776065785534,-0.753186799035982,0.393992040057209,0.0429382569342210,-0.471396736820848,0.806847553535225,-0.983105487420902,0.965394441687668,-0.757208846498737,0.399624199841710,0.0368072229406963,-0.465976495762822,0.803207531472024,-0.981963869099151,0.966976471034715,-0.761202385476395,0.405241314000955,0.0306748031760327,-0.460538710953104,0.799537269099239,-0.980785280392737,0.968522094264165,-0.765167265614474,0.410843171053770,0.0245412285223681,-0.455083587121216,0.795836904600173,-0.979569765674858,0.970031253184176,-0.769103337637475,0.416429560093403,0.0184067299053218,-0.449611329649489,0.792106577291459,-0.978317370708958,0.971503890975769,-0.773010453354512,0.422000270795464,0.0122715382852992,-0.444122144565323,0.788346427617811,-0.977028142646998,0.972939952194962,-0.776888465664887,0.427555093425845,0.00613588464879735,-0.438616238533434,0.784556597146739,-0.975702130027685,0.974339382774863,-0.780737228563629,0.433093818848611,-2.92266211229328e-13,-0.433093818848072,0.780737228563218,-0.974339382774646,0.975702130027700,-0.784556597146988,0.438616238533883,-0.00613588464938057,-0.427555093425217,0.776888465664317,-0.972939952194546,0.977028142646811,-0.788346427617897,0.444122144565680,-0.0122715382858788,-0.422000270794751,0.773010453353784,-0.971503890975153,0.978317370708570,-0.792106577291380,0.449611329649751,-0.0184067299058951,-0.416429560092607,0.769103337636590,-0.970031253183361,0.979569765674268,-0.795836904599929,0.455083587121381,-0.0245412285229326,-0.410843171052892,0.765167265613434,-0.968522094263151,0.980785280391943,-0.799537269098827,0.460538710953170,-0.0306748031765858,-0.405241313999999,0.761202385475202,-0.966976471033503,0.981963869098154,-0.803207531471443,0.465976495762787,-0.0368072229412358,-0.399624199840677,0.757208846497391,-0.965394441686259,0.983105487419701,-0.806847553534473,0.471396736820709,-0.0429382569347441,-0.393992040056101,0.753186799034487,-0.963776065783928,0.984210092375300,-0.810457198243144,0.476799230057923,-0.0490676743271467,-0.388345046693904,0.749136394514303,-0.962121404257449,0.985277642377198,-0.814036329696373,0.482183772073612,-0.0551952443493425,-0.382683432360193,0.745057785432279,-0.960430519403894,0.986308097232741,-0.817584813141883,0.487550160142813,-0.0613207363017838,-0.377007410211548,0.740951125345744,-0.958703474884121,0.987301418145888,-0.821102514981278,0.492898192224048,-0.0674439195631608,-0.371317193946996,0.736816568868127,-0.956940335720380,0.988257567718666,-0.824589302775073,0.498227666966931,-0.0735645635990844,-0.365612997799962,0.732654271663144,-0.955141168293865,0.989176509952584,-0.828045045247677,0.503538383719752,-0.0796824379707661,-0.359895036530207,0.728464390438931,-0.953306040342212,0.990058210249987,-0.831469612292339,0.508830142537026,-0.0857973123436937,-0.354163525415741,0.724247082942148,-0.951435020956950,0.990902635415358,-0.834862874976047,0.514102744187023,-0.0919089564963034,-0.348418680244719,0.720002507952040,-0.949528180580904,0.991709753656565,-0.838224705544378,0.519355990159274,-0.0980171403286466,-0.342660717307314,0.715730825274455,-0.947585591005534,0.992479534586064,-0.841554977426310,0.524589682672035,-0.104121633871055,-0.336889853387576,0.711432195735833,-0.945607325368241,0.993211949222037,-0.844853565238991,0.529803624679741,-0.110222207292796,-0.331106305755270,0.707106781177144,-0.943593458149608,0.993906969989487,-0.848120344792453,0.534997619880424,-0.116318630910730,-0.325310292157695,0.702754744447804,-0.941544065170596,0.994564570721275,-0.851355193094292,0.540171472723098,-0.122410675197952,-0.319502030811488,0.698376249399535,-0.939459223589694,0.995184726659106,-0.854557988354298,0.545324988415130,-0.128498110792438,-0.313681740394405,0.693971460880200,-0.937339011900010,0.995767414454458,-0.857728609989041,0.550457972929566,-0.134580708505680,-0.307849640037092,0.689540544727599,-0.935183509926314,0.996312612169467,-0.860866938626407,0.555570233012440,-0.140658239331310,-0.302005949314829,0.685083667763219,-0.932992798822036,0.996820299277745,-0.863972856110096,0.560661576190050,-0.146730474453728,-0.296150888239270,0.680600997785959,-0.930766961066214,0.997290456665160,-0.867046245504072,0.565731810776202,-0.152797185256714,-0.290284677250156,0.676092703565812,-0.928506080460380,0.997723066630552,-0.870086991096961,0.570780745879431,-0.158858143332036,-0.284407537207014,0.671558954837505,-0.926210242125410,0.998118112886402,-0.873094978406409,0.575808191410182,-0.164913120488047,-0.278519689380844,0.666999922294116,-0.923879532498321,0.998475580559439,-0.876070094183396,0.580813958087974,-0.170961888758279,-0.272621355445791,0.662415777580643,-0.921514039329012,0.998795456191209,-0.879012226416492,0.585797857448521,-0.177004220410027,-0.266712757470793,0.657806693287544,-0.919113851676966,0.999077727738575,-0.881921264336083,0.590759701850828,-0.183039887952918,-0.260794117911224,0.653172842944238,-0.916679059907889,0.999322384574172,-0.884797098418534,0.595699304484257,-0.189068664147481,-0.254865659600518,0.648514401012570,-0.914209755690316,0.999529417486810,-0.887639620390320,0.600616479375563,-0.195090322013700,-0.248927605741780,0.643831542880248,-0.911706031992156,0.999698818681815,-0.890448723232093,0.605511041395889,-0.201104634839559,-0.242980179899381,0.639124444854231,-0.909167983077190,0.999830581781328,-0.893224301182718,0.610382806267742,-0.207111376189580,-0.237023605990543,0.634393284154102,-0.906595704501525,0.999924701824545,-0.895966249743257,0.615231590571927,-0.213110319913346,-0.231058108276908,0.629638238905385,-0.903989293109996,0.999981175267897,-0.898674465680894,0.620057211754456,-0.219101240154017,-0.225083911356091,0.624859488132848,-0.901348847032519};
const static double fft_ratio_585_I[1024]={0,0.433093818853145,-0.780737228572071,0.974339382785533,-0.975702130038472,0.784556597155520,-0.438616238538492,0.00613588464915646,0.427555093430230,-0.776888465673129,0.972939952205419,-0.977028142657600,0.788346427626472,-0.444122144570350,0.0122715382857228,0.422000270799703,-0.773010453362554,0.971503890986011,-0.978317370719374,0.792106577299999,-0.449611329654483,0.0184067299058073,0.416429560097497,-0.769103337645318,0.970031253194205,-0.979569765685088,0.795836904608590,-0.455083587126175,0.0245412285229130,0.410843171057722,-0.765167265622120,0.968522094273980,-0.980785280402779,0.799537269107531,-0.460538710958025,0.0306748031766344,0.405241314004766,-0.761202385483845,0.966976471044317,-0.981963869109004,0.803207531480189,-0.465976495767704,0.0368072229413525,0.399624199845383,-0.757208846505992,0.965394441697057,-0.983105487430566,0.806847553543261,-0.471396736825687,0.0429382569349290,0.393992040060746,-0.753186799043044,0.963776065794710,-0.984210092386178,0.810457198251974,-0.476799230062961,0.0490676743273997,0.388345046698486,-0.749136394522816,0.962121404268215,-0.985277642388090,0.814036329705244,-0.482183772078711,0.0551952443496637,0.382683432364713,-0.745057785440749,0.960430519414642,-0.986308097243647,0.817584813150795,-0.487550160147973,0.0613207363021731,0.377007410216006,-0.740951125354169,0.958703474894851,-0.987301418156807,0.821102514990230,-0.492898192229268,0.0674439195636182,0.371317193951391,-0.736816568876508,0.956940335731093,-0.988257567729597,0.824589302784065,-0.498227666972211,0.0735645635996099,0.365612997804294,-0.732654271671480,0.955141168304559,-0.989176509963527,0.828045045256709,-0.503538383725092,0.0796824379713597,0.359895036534477,-0.728464390447221,0.953306040352887,-0.990058210260942,0.831469612301411,-0.508830142542425,0.0857973123443554,0.354163525419948,-0.724247082950393,0.951435020967607,-0.990902635426324,0.834862874985158,-0.514102744192483,0.0919089564970331,0.348418680248863,-0.720002507960239,0.949528180591541,-0.991709753667542,0.838224705553528,-0.519355990164792,0.0980171403294443,0.342660717311394,-0.715730825282609,0.947585591016151,-0.992479534597050,0.841554977435499,-0.524589682677612,0.104121633871920,0.336889853391592,-0.711432195743939,0.945607325378838,-0.993211949233033,0.844853565248217,-0.529803624685377,0.110222207293730,0.331106305759223,-0.707106781185204,0.943593458160184,-0.993906970000493,0.848120344801717,-0.534997619886118,0.116318630911731,0.325310292161584,-0.702754744455817,0.941544065181152,-0.994564570732290,0.851355193103594,-0.540171472728852,0.122410675199021,0.319502030815313,-0.698376249407500,0.939459223600228,-0.995184726670130,0.854557988363637,-0.545324988420942,0.128498110793576,0.313681740398167,-0.693971460888118,0.937339011910522,-0.995767414465491,0.857728609998416,-0.550457972935435,0.134580708506885,0.307849640040789,-0.689540544735468,0.935183509936803,-0.996312612180507,0.860866938635819,-0.555570233018367,0.140658239332582,0.302005949318462,-0.685083667771040,0.932992798832504,-0.996820299288793,0.863972856119545,-0.560661576196035,0.146730474455069,0.296150888242839,-0.680600997793733,0.930766961076658,-0.997290456676215,0.867046245513556,-0.565731810782244,0.152797185258123,0.290284677253659,-0.676092703573536,0.928506080470800,-0.997723066641614,0.870086991106480,-0.570780745885530,0.158858143333512,0.284407537210452,-0.671558954845180,0.926210242135807,-0.998118112897469,0.873094978415964,-0.575808191416338,0.164913120489590,0.278519689384218,-0.666999922301741,0.923879532508694,-0.998475580570512,0.876070094192984,-0.580813958094187,0.170961888759890,0.272621355449100,-0.662415777588219,0.921514039339361,-0.998795456202288,0.879012226426115,-0.585797857454790,0.177004220411705,0.266712757474037,-0.657806693295070,0.919113851687289,-0.999077727749658,0.881921264345740,-0.590759701857153,0.183039887954664,0.260794117914402,-0.653172842951713,0.916679059918187,-0.999322384585260,0.884797098428225,-0.595699304490639,0.189068664149294,0.254865659603631,-0.648514401019995,0.914209755700588,-0.999529417497901,0.887639620400043,-0.600616479382000,0.195090322015580,0.248927605744827,-0.643831542887621,0.911706032002402,-0.999698818692910,0.890448723241849,-0.605511041402381,0.201104634841506,0.242980179902363,-0.639124444861554,0.909167983087409,-0.999830581792427,0.893224301192507,-0.610382806274289,0.207111376191594,0.237023605993460,-0.634393284161373,0.906595704511717,-0.999924701835646,0.895966249753078,-0.615231590578529,0.213110319915427,0.231058108279758,-0.629638238912605,0.903989293120161,-0.999981175279001,0.898674465690747,-0.620057211761114,0.219101240156165,0.225083911358876,-0.624859488140016,0.901348847042656,-0.999999999996298,0.901348847042715,-0.624859488140132,0.225083911359046,0.219101240155949,-0.620057211760871,0.898674465690505,-0.999981175278797,0.903989293120035,-0.629638238912593,0.231058108279881,0.213110319915169,-0.615231590578162,0.895966249752655,-0.999924701835239,0.906595704511406,-0.634393284161230,0.237023605993532,0.207111376191296,-0.610382806273799,0.893224301191903,-0.999830581791817,0.909167983086912,-0.639124444861279,0.242980179902383,0.201104634841170,-0.605511041401771,0.890448723241065,-0.999698818692096,0.911706032001717,-0.643831542887212,0.248927605744793,0.195090322015208,-0.600616479381271,0.887639620399081,-0.999529417496883,0.914209755699715,-0.648514401019450,0.254865659603539,0.189068664148889,-0.595699304489793,0.884797098427085,-0.999322384584039,0.916679059917125,-0.653172842951030,0.260794117914251,0.183039887954229,-0.590759701856192,0.881921264344423,-0.999077727748234,0.919113851686037,-0.657806693294246,0.266712757473823,0.177004220411242,-0.585797857453717,0.879012226424624,-0.998795456200660,0.921514039337917,-0.662415777587253,0.272621355448823,0.170961888759402,-0.580813958093004,0.876070094191320,-0.998475580568682,0.923879532507058,-0.666999922300632,0.278519689383874,0.164913120489078,-0.575808191415047,0.873094978414127,-0.998118112895436,0.926210242133978,-0.671558954843926,0.284407537210039,0.158858143332979,-0.570780745884132,0.870086991104472,-0.997723066639379,0.928506080468778,-0.676092703572135,0.290284677253174,0.152797185257572,-0.565731810780742,0.867046245511378,-0.997290456673777,0.930766961074442,-0.680600997792182,0.296150888242280,0.146730474454502,-0.560661576194430,0.863972856117198,-0.996820299286153,0.932992798830091,-0.685083667769340,0.302005949317827,0.140658239332003,-0.555570233016663,0.860866938633304,-0.996312612177666,0.935183509934194,-0.689540544733615,0.307849640040075,0.134580708506295,-0.550457972933633,0.857728609995736,-0.995767414462449,0.937339011907716,-0.693971460886111,0.313681740397372,0.128498110792977,-0.545324988419044,0.854557988360793,-0.995184726666887,0.939459223597225,-0.698376249405337,0.319502030814435,0.122410675198417,-0.540171472726860,0.851355193100586,-0.994564570728847,0.941544065177949,-0.702754744453496,0.325310292160621,0.116318630911124,-0.534997619884035,0.848120344798548,-0.993906969996850,0.943593458156782,-0.707106781182724,0.331106305758171,0.110222207293122,-0.529803624683205,0.844853565244888,-0.993211949229190,0.945607325375237,-0.711432195741298,0.336889853390451,0.104121633871314,-0.524589682675352,0.841554977432010,-0.992479534593008,0.947585591012349,-0.715730825279805,0.342660717310160,0.0980171403288422,-0.519355990162448,0.838224705549882,-0.991709753663300,0.949528180587537,-0.720002507957272,0.348418680247534,0.0919089564964376,-0.514102744190055,0.834862874981357,-0.990902635421884,0.951435020963402,-0.724247082947260,0.354163525418522,0.0857973123437693,-0.508830142539917,0.831469612297455,-0.990058210256304,0.953306040348479,-0.728464390443920,0.359895036532951,0.0796824379707853,-0.503538383722506,0.828045045252600,-0.989176509958692,0.955141168299948,-0.732654271668010,0.365612997802667,0.0735645635990497,-0.498227666969549,0.824589302779805,-0.988257567724565,0.956940335726278,-0.736816568872867,0.371317193949660,0.0674439195630746,-0.492898192226532,0.821102514985821,-0.987301418151578,0.958703474889833,-0.740951125350357,0.377007410214169,0.0613207363016487,-0.487550160145165,0.817584813146237,-0.986308097238224,0.960430519409419,-0.745057785436763,0.382683432362768,0.0551952443491609,-0.482183772075835,0.814036329700539,-0.985277642382472,0.962121404262786,-0.749136394518655,0.388345046696431,0.0490676743269211,-0.476799230060018,0.810457198247125,-0.984210092380365,0.963776065789075,-0.753186799038707,0.393992040058578,0.0429382569344773,-0.471396736822679,0.806847553538269,-0.983105487424559,0.965394441691216,-0.757208846501476,0.399624199843100,0.0368072229409299,-0.465976495764634,0.803207531475055,-0.981963869102804,0.966976471038270,-0.761202385479150,0.405241314002366,0.0306748031762436,-0.460538710954895,0.799537269102257,-0.980785280396387,0.968522094267726,-0.765167265617244,0.410843171055202,0.0245412285225564,-0.455083587122988,0.795836904603178,-0.979569765678505,0.970031253187743,-0.769103337640260,0.416429560094856,0.0184067299054873,-0.449611329651240,0.792106577294450,-0.978317370712600,0.971503890979342,-0.773010453357312,0.422000270796938,0.0122715382854420,-0.444122144567054,0.788346427620789,-0.977028142650635,0.972939952198541,-0.776888465667702,0.427555093427339,0.00613588464891749,-0.438616238535145,0.784556597149703,-0.975702130031318,0.974339382778448,-0.780737228566458,0.433093818850127,-1.94844140820274e-13,-0.433093818849763,0.780737228566169,-0.974339382778275,0.975702130031291,-0.784556597149832,0.438616238535419,-0.00613588464930587,-0.427555093426888,0.776888465667254,-0.972939952198170,0.977028142650407,-0.788346427620755,0.444122144567237,-0.0122715382858268,-0.422000270796402,0.773010453356707,-0.971503890978772,0.978317370712171,-0.792106577294253,0.449611329651328,-0.0184067299058658,-0.416429560094237,0.769103337639499,-0.970031253186976,0.979569765677875,-0.795836904602816,0.455083587122979,-0.0245412285229261,-0.410843171054502,0.765167265616329,-0.968522094266761,0.980785280395555,-0.799537269101728,0.460538710954788,-0.0306748031766020,-0.405241314001588,0.761202385478083,-0.966976471037108,0.981963869101771,-0.803207531474358,0.465976495764426,-0.0368072229412747,-0.399624199842246,0.757208846500258,-0.965394441689858,0.983105487423322,-0.806847553537402,0.471396736822368,-0.0429382569348057,-0.393992040057650,0.753186799037339,-0.963776065787522,0.984210092378926,-0.810457198246087,0.476799230059602,-0.0490676743272310,-0.388345046695431,0.749136394517141,-0.962121404261038,0.985277642380829,-0.814036329699330,0.482183772075312,-0.0551952443494496,-0.382683432361700,0.745057785435103,-0.960430519407477,0.986308097236377,-0.817584813144853,0.487550160144533,-0.0613207363019136,-0.377007410213034,0.740951125348552,-0.958703474887698,0.987301418149527,-0.821102514984262,0.492898192225788,-0.0674439195633132,-0.371317193948461,0.736816568870920,-0.956940335723951,0.988257567722309,-0.824589302778070,0.498227666968691,-0.0735645635992595,-0.365612997801406,0.732654271665922,-0.955141168297430,0.989176509956232,-0.828045045250687,0.503538383721532,-0.0796824379709640,-0.359895036531630,0.728464390441694,-0.953306040345770,0.990058210253639,-0.831469612295363,0.508830142538825,-0.0857973123439142,-0.354163525417144,0.724247082944897,-0.951435020960503,0.990902635419013,-0.834862874979084,0.514102744188843,-0.0919089564965466,-0.348418680246100,0.720002507954773,-0.949528180584449,0.991709753660224,-0.838224705547428,0.519355990161113,-0.0980171403289125,-0.342660717308674,0.715730825277173,-0.947585591009073,0.992479534589726,-0.841554977429373,0.524589682673894,-0.104121633871343,-0.336889853388915,0.711432195738535,-0.945607325371773,0.993211949225702,-0.844853565242066,0.529803624681620,-0.110222207293108,-0.331106305756587,0.707106781179831,-0.943593458153133,0.993906969993155,-0.848120344795541,0.534997619882322,-0.116318630911064,-0.325310292158992,0.702754744450475,-0.941544065174115,0.994564570724947,-0.851355193097392,0.540171472725016,-0.122410675198308,-0.319502030812763,0.698376249402190,-0.939459223593206,0.995184726662781,-0.854557988357411,0.545324988417067,-0.128498110792817,-0.313681740395659,0.693971460882840,-0.937339011903514,0.995767414458136,-0.857728609992166,0.550457972931522,-0.134580708506081,-0.307849640038324,0.689540544730222,-0.935183509929810,0.996312612173147,-0.860866938629544,0.555570233014416,-0.140658239331734,-0.302005949316040,0.685083667765826,-0.932992798825526,0.996820299281427,-0.863972856113246,0.560661576192045,-0.146730474454175,-0.296150888240460,0.680600997788550,-0.930766961069695,0.997290456668845,-0.867046245507234,0.565731810778216,-0.152797185257184,-0.290284677251324,0.676092703568387,-0.928506080463853,0.997723066634239,-0.870086991100134,0.570780745881464,-0.158858143332528,-0.284407537208160,0.671558954840063,-0.926210242128876,0.998118112890091,-0.873094978409594,0.575808191412234,-0.164913120488561,-0.278519689381969,0.666999922296657,-0.923879532501779,0.998475580563130,-0.876070094186592,0.580813958090045,-0.170961888758816,-0.272621355446894,0.662415777583168,-0.921514039332462,0.998795456194902,-0.879012226419700,0.585797857450611,-0.177004220410586,-0.266712757471874,0.657806693290053,-0.919113851680407,0.999077727742269,-0.881921264339302,0.590759701852936,-0.183039887953500,-0.260794117912283,0.653172842946730,-0.916679059911322,0.999322384577868,-0.884797098421765,0.595699304486384,-0.189068664148085,-0.254865659601555,0.648514401015045,-0.914209755693740,0.999529417490507,-0.887639620393561,0.600616479377709,-0.195090322014326,-0.248927605742795,0.643831542882706,-0.911706031995571,0.999698818685513,-0.890448723235345,0.605511041398053,-0.201104634840208,-0.242980179900375,0.639124444856672,-0.909167983080596,0.999830581785028,-0.893224301185981,0.610382806269924,-0.207111376190251,-0.237023605991515,0.634393284156525,-0.906595704504922,0.999924701828245,-0.895966249746531,0.615231590574128,-0.213110319914040,-0.231058108277858,0.629638238907792,-0.903989293113384,0.999981175271598,-0.898674465684178,0.620057211756675,-0.219101240154733,-0.225083911357019,0.624859488135237,-0.901348847035898,0.999999999988894,-0.901348847036125,0.624859488135657,-0.225083911357569,-0.219101240154137,0.620057211756127,-0.898674465683766,0.999981175271392,-0.903989293113425,0.629638238908082,-0.231058108278360,-0.213110319913401,0.615231590573453,-0.895966249745934,0.999924701827833,-0.906595704504776,0.634393284156684,-0.237023605991967,-0.207111376189572,0.610382806269125,-0.893224301185202,0.999830581784410,-0.909167983080261,0.639124444856697,-0.242980179900773,-0.201104634839490,0.605511041397133,-0.890448723234383,0.999698818684689,-0.911706031995047,0.643831542882594,-0.248927605743138,-0.195090322013573,0.600616479376668,-0.887639620392419,0.999529417489477,-0.914209755693025,0.648514401014796,-0.254865659601841,-0.189068664147298,0.595699304485226,-0.884797098420443,0.999322384576633,-0.916679059910415,0.653172842946341,-0.260794117912508,-0.183039887952682,0.590759701851661,-0.881921264337802,0.999077727740828,-0.919113851679308,0.657806693289523,-0.266712757472036,-0.177004220409740,0.585797857449222,-0.879012226418023,0.998795456193255,-0.921514039331170,0.662415777582495,-0.272621355446991,-0.170961888757944,0.580813958088545,-0.876070094184739,0.998475580561278,-0.923879532500292,0.666999922295839,-0.278519689381999,-0.164913120487665,0.575808191410624,-0.873094978407567,0.998118112888034,-0.926210242127194,0.671558954839098,-0.284407537208120,-0.158858143331611,0.570780745879746,-0.870086991097934,0.997723066631978,-0.928506080461976,0.676092703567272,-0.290284677251211,-0.152797185256248,0.565731810776393,-0.867046245504861,0.997290456666379,-0.930766961067621,0.680600997787286,-0.296150888240273,-0.146730474453223,0.560661576190118,-0.863972856110703,0.996820299278757,-0.932992798823253,0.685083667764409,-0.302005949315776,-0.140658239330769,0.555570233012387,-0.860866938626831,0.996312612170273,-0.935183509927339,0.689540544728651,-0.307849640037981,-0.134580708505105,0.550457972929395,-0.857728609989285,0.995767414455058,-0.937339011900844,0.693971460881113,-0.313681740395234,-0.128498110791833,0.545324988414842,-0.854557988354364,0.995184726659500,-0.939459223590336,0.698376249400306,-0.319502030812254,-0.122410675197317,0.540171472722696,-0.851355193094180,0.994564570721463,-0.941544065171044,0.702754744448432,-0.325310292158396,-0.116318630910069,0.534997619879909,-0.848120344792165,0.993906969989469,-0.943593458149861,0.707106781177627,-0.331106305755904,-0.110222207292112,0.529803624679117,-0.844853565238528,0.993211949221814,-0.945607325368299,0.711432195736168,-0.336889853388140,-0.104121633870349,0.524589682671302,-0.841554977425674,0.992479534585636,-0.947585591005396,0.715730825274642,-0.342660717307806,-0.0980171403279225,0.519355990158436,-0.838224705543569,0.991709753655933,-0.949528180580568,0.720002507952076,-0.348418680245137,-0.0919089564955630,0.514102744186082,-0.834862874975068,0.990902635414521,-0.951435020956417,0.724247082942032,-0.354163525416082,-0.0857973123429399,0.508830142535982,-0.831469612291191,0.990058210248947,-0.953306040341480,0.728464390438660,-0.359895036530469,-0.0796824379700011,0.503538383718609,-0.828045045246360,0.989176509951339,-0.955141168292934,0.732654271662718,-0.365612997800142,-0.0735645635983107,0.498227666965692,-0.824589302773590,0.988257567717218,-0.956940335719250,0.736816568867544,-0.371317193947092,-0.0674439195623809,0.492898192222713,-0.821102514979630,0.987301418144237,-0.958703474882790,0.740951125345002,-0.377007410211559,-0.0613207363010002,0.487550160141385,-0.817584813140071,0.986308097230889,-0.960430519402362,0.745057785431377,-0.382683432360115,-0.0551952443485577,0.482183772072094,-0.814036329694399,0.985277642375143,-0.962121404255716,0.749136394513238,-0.388345046693735,-0.0490676743263632,0.476799230056317,-0.810457198241010,0.984210092373044,-0.963776065781992,0.753186799033258,-0.393992040055840,-0.0429382569339647,0.471396736819017,-0.806847553532180,0.983105487417244,-0.965394441684119,0.757208846495997,-0.399624199840320,-0.0368072229404627,0.465976495761011,-0.803207531468993,0.981963869095497,-0.966976471031160,0.761202385473641,-0.405241313999544,-0.0306748031758217,0.460538710951312,-0.799537269096221,0.980785280389087,-0.968522094260604,0.765167265611704,-0.410843171052338,-0.0245412285221799,0.455083587119445,-0.795836904597168,0.979569765671212,-0.970031253180609,0.769103337634690,-0.416429560091950,-0.0184067299051562,0.449611329647737,-0.792106577288467,0.978317370705316,-0.971503890972195,0.773010453351713,-0.422000270793990,-0.0122715382851564,0.444122144563591,-0.788346427614832,0.977028142643360,-0.972939952191383,0.776888465662073,-0.427555093424350,-0.00613588464867722,0.438616238531722,-0.784556597143774,0.975702130024052,-0.974339382771277,0.780737228560799,-0.433093818847096};
const static double fft_ratio_586_R[1024]={1,-0.898674465693941,0.615231590580610,-0.207111376192211,-0.242980179903248,0.643831542889743,-0.914209755703450,0.999322384588248,-0.881921264348254,0.585797857456365,-0.170961888760280,-0.278519689385005,0.671558954846898,-0.928506080473039,0.997290456678489,-0.863972856121402,0.555570233019479,-0.134580708507099,-0.313681740398803,0.698376249408776,-0.941544065182745,0.993906970002055,-0.844853565249442,0.524589682678302,-0.0980171403295357,-0.348418680249299,0.724247082951187,-0.953306040353818,0.989176509964381,-0.824589302784685,0.492898192229580,-0.0613207363021929,-0.382683432364901,0.749136394523093,-0.963776065794962,0.983105487430721,-0.803207531480234,0.460538710958006,-0.0245412285229133,-0.416429560097388,0.773010453362279,-0.972939952204979,0.975702130037939,-0.780737228571619,0.427555093430025,0.0122715382856948,-0.449611329654291,0.795836904608331,-0.980785280402545,0.966976471044170,-0.757208846505949,0.393992040060775,0.0490676743273613,-0.482183772078735,0.817584813150932,-0.987301418157069,0.956940335731439,-0.732654271671823,0.359895036534706,0.0857973123443442,-0.514102744192755,0.838224705554085,-0.992479534597816,0.945607325379666,-0.707106781185909,0.325310292161980,0.122410675199074,-0.545324988421496,0.857728609999414,-0.996312612181780,0.932992798833802,-0.680600997794773,0.290284677254186,0.158858143333666,-0.575808191417205,0.876070094194441,-0.998795456204071,0.919113851689044,-0.653172842953061,0.254865659604252,0.195090322015872,-0.605511041403591,0.893224301194440,-0.999924701837942,0.903989293122357,-0.624859488141642,0.219101240156629,0.231058108280348,-0.634393284162811,0.909167983089336,-0.999698818694902,0.887639620401700,-0.595699304491668,0.183039887954929,0.266712757474501,-0.662415777589233,0.923879532509988,-0.998118112898749,0.870086991107495,-0.565731810782833,0.146730474455187,0.302005949318749,-0.689540544736020,0.937339011911163,-0.995184726670702,0.851355193103991,-0.534997619886310,0.110222207293753,0.336889853391654,-0.715730825282660,0.949528180591511,-0.990902635426192,0.831469612301220,-0.503538383724931,0.0735645635995893,0.371317193951178,-0.740951125353684,0.960430519413926,-0.985277642387265,0.810457198251224,-0.471396736825219,0.0368072229413405,0.405241314004231,-0.765167265621066,0.970031253192790,-0.978317370717866,0.788346427625197,-0.438616238537764,4.87943019321855e-14,0.438616238537664,-0.788346427625091,0.978317370717761,-0.970031253192701,0.765167265621017,-0.405241314004250,-0.0368072229412354,0.471396736825023,-0.810457198250956,0.985277642386963,-0.960430519413647,0.740951125353492,-0.371317193951129,-0.0735645635994621,0.503538383724627,-0.831469612300780,0.990902635425691,-0.949528180591046,0.715730825282334,-0.336889853391551,-0.110222207293589,0.534997619885887,-0.851355193103373,0.995184726670000,-0.937339011910518,0.689540544735571,-0.302005949318606,-0.146730474454971,0.565731810782277,-0.870086991106690,0.998118112897847,-0.923879532509169,0.662415777588673,-0.266712757474332,-0.183039887954648,0.595699304490968,-0.887639620400703,0.999698818693799,-0.909167983088350,0.634393284162151,-0.231058108280168,-0.219101240156267,0.624859488140788,-0.903989293121163,0.999924701836640,-0.893224301193294,0.605511041402844,-0.195090322015697,-0.254865659603796,0.653172842952041,-0.919113851687648,0.998795456202572,-0.876070094193143,0.575808191416384,-0.158858143333509,-0.290284677253622,0.680600997793578,-0.932992798832200,0.996312612180086,-0.857728609997973,0.545324988420614,-0.122410675198951,-0.325310292161294,0.707106781184529,-0.945607325377854,0.992479534595930,-0.838224705552511,0.514102744191826,-0.0857973123442698,-0.359895036533885,0.732654271670249,-0.956940335729414,0.987301418154996,-0.817584813149236,0.482183772077773,-0.0490676743273509,-0.393992040059806,0.757208846504174,-0.966976471041933,0.980785280400291,-0.795836904606523,0.449611329653310,-0.0122715382857629,-0.427555093428896,0.780737228569635,-0.975702130035486,0.972939952202549,-0.773010453360371,0.416429560096403,0.0245412285227517,-0.460538710956705,0.803207531478035,-0.983105487428054,0.963776065792363,-0.749136394521096,0.382683432363927,0.0613207363019231,-0.492898192228096,0.824589302782265,-0.989176509961501,0.953306040351058,-0.724247082949114,0.348418680248351,0.0980171403291432,-0.524589682676623,0.844853565246796,-0.993906969998963,0.941544065179832,-0.698376249406640,0.313681740397896,0.134580708506570,-0.555570233017595,0.863972856118524,-0.997290456675187,0.928506080469982,-0.671558954844714,0.278519689384154,0.170961888759600,-0.585797857454267,0.881921264345142,-0.999322384584742,0.914209755700258,-0.643831542887524,0.242980179902470,0.207111376191365,-0.615231590578287,0.898674465690592,-0.999999999996292,0.898674465690651,-0.615231590578405,0.207111376191538,0.242980179902253,-0.643831542887281,0.914209755700021,-0.999322384584546,0.881921264345030,-0.585797857454272,0.170961888759742,0.278519689383878,-0.671558954844336,0.928506080469559,-0.997290456674797,0.863972856118247,-0.555570233017499,0.134580708506697,0.313681740397547,-0.698376249406116,0.941544065179221,-0.993906969998380,0.844853565246361,-0.524589682676439,0.0980171403292693,0.348418680247916,-0.724247082948434,0.953306040350254,-0.989176509960727,0.824589302781682,-0.492898192227837,0.0613207363020629,0.382683432363392,-0.749136394520250,0.963776065791362,-0.983105487427093,0.803207531477314,-0.460538710956385,0.0245412285229198,0.416429560095756,-0.773010453359351,0.972939952201348,-0.975702130034342,0.780737228568784,-0.427555093428528,-0.0122715382855517,0.449611329652537,-0.795836904605321,0.980785280398889,-0.966976471040610,0.757208846503204,-0.393992040059404,-0.0490676743270818,0.482183772076861,-0.817584813147844,0.987301418153392,-0.956940335727919,0.732654271669172,-0.359895036533463,-0.0857973123439288,0.514102744190765,-0.838224705550923,0.992479534594123,-0.945607325376191,0.707106781183356,-0.325310292160866,-0.122410675198523,0.545324988419392,-0.857728609996183,0.996312612178077,-0.932992798830378,0.680600997792321,-0.290284677253203,-0.158858143332981,0.575808191414990,-0.876070094191145,0.998795456200363,-0.919113851685674,0.653172842950713,-0.254865659603401,-0.195090322015053,0.605511041401267,-0.893224301191084,0.999924701834233,-0.903989293119046,0.624859488139401,-0.219101240155911,-0.231058108279396,0.634393284160383,-0.909167983085924,0.999698818691197,-0.887639620398453,0.595699304489537,-0.183039887954346,-0.266712757473418,0.662415777586703,-0.923879532506524,0.998118112895054,-0.870086991104316,0.565731810780816,-0.146730474454739,-0.302005949317537,0.689540544733392,-0.937339011907653,0.995184726667021,-0.851355193100885,0.534997619884408,-0.110222207293441,-0.336889853390313,0.715730825279937,-0.949528180587959,0.990902635422531,-0.831469612298191,0.503538383723147,-0.0735645635994138,-0.371317193949711,0.740951125350871,-0.960430519410337,0.985277642383628,-0.810457198248276,0.471396736823557,-0.0368072229413015,-0.405241314002639,0.765167265618165,-0.970031253189169,0.978317370714258,-0.788346427622333,0.438616238536225,-1.46382905796014e-13,-0.438616238535950,0.788346427622108,-0.978317370714113,0.970031253189128,-0.765167265618243,0.405241314002836,0.0368072229410014,-0.471396736823189,0.810457198247893,-0.985277642383292,0.960430519410112,-0.740951125350810,0.371317193949843,0.0735645635990920,-0.503538383722676,0.831469612297643,-0.990902635422004,0.949528180587555,-0.715730825279748,0.336889853390393,0.110222207293083,-0.534997619883820,0.851355193100164,-0.995184726666300,0.937339011907076,-0.689540544733085,0.302005949317579,0.146730474454331,-0.565731810780099,0.870086991103416,-0.998118112894139,0.923879532505780,-0.662415777586289,0.266712757473437,0.183039887953873,-0.595699304488681,0.887639620397367,-0.999698818690089,0.909167983085019,-0.634393284159874,0.231058108279406,0.219101240155359,-0.624859488138394,0.903989293117769,-0.999924701832933,0.893224301190025,-0.605511041400676,0.195090322015069,0.254865659602756,-0.653172842949545,0.919113851684201,-0.998795456198872,0.876070094189941,-0.575808191414328,0.158858143333016,0.290284677252452,-0.680600997790982,0.932992798828705,-0.996312612176399,0.857728609994842,-0.545324988418673,0.122410675198594,0.325310292159995,-0.707106781181838,0.945607325374315,-0.992479534592262,0.838224705549456,-0.514102744190003,0.0857973123440489,0.359895036532460,-0.732654271667466,0.956940335725837,-0.987301418151350,0.817584813146260,-0.482183772076070,0.0490676743272664,0.393992040058255,-0.757208846501302,0.966976471038322,-0.980785280396673,0.795836904603630,-0.449611329651730,0.0122715382858150,0.427555093427222,-0.780737228566679,0.975702130031846,-0.972939952198964,0.773010453357566,-0.416429560094948,-0.0245412285225631,0.460538710954910,-0.803207531474998,0.983105487424390,-0.963776065788815,0.749136394518382,-0.382683432362598,-0.0613207363015983,0.492898192226183,-0.824589302779152,0.989176509957819,-0.953306040347552,0.724247082946496,-0.348418680247151,-0.0980171403286825,0.524589682674594,-0.844853565243610,0.993906969995266,-0.941544065176374,0.698376249404120,-0.313681740396826,-0.134580708505974,0.555570233015453,-0.863972856115271,0.997290456671482,-0.928506080466575,0.671558954842296,-0.278519689383215,-0.170961888758869,0.585797857452015,-0.881921264341826,0.999322384581032,-0.914209755696908,0.643831542885211,-0.242980179901664,-0.207111376190502,0.615231590575929,-0.898674465687216,0.999999999992583,-0.898674465687361,0.615231590576200,-0.207111376190866,-0.242980179901257,0.643831542884819,-0.914209755696591,0.999322384580844,-0.881921264341805,0.585797857452179,-0.170961888759205,-0.278519689382752,0.671558954841773,-0.928506080466080,0.997290456671106,-0.863972856115092,0.555570233015520,-0.134580708506295,-0.313681740396291,0.698376249403456,-0.941544065175696,0.993906969994705,-0.844853565243281,0.524589682674577,-0.0980171403290029,-0.348418680246532,0.724247082945681,-0.953306040346689,0.989176509957073,-0.824589302778680,0.492898192226094,-0.0613207363019329,-0.382683432361883,0.749136394517407,-0.963776065787762,0.983105487423465,-0.803207531474393,0.460538710954763,-0.0245412285229264,-0.416429560094122,0.773010453356422,-0.972939952197718,0.975702130030745,-0.780737228565950,0.427555093427030,0.0122715382854086,-0.449611329650782,0.795836904602310,-0.980785280395233,0.966976471037049,-0.757208846500460,0.393992040058032,0.0490676743268024,-0.482183772074988,0.817584813144756,-0.987301418149715,0.956940335724398,-0.732654271666521,0.359895036532219,0.0857973123435133,-0.514102744188775,0.838224705547762,-0.992479534590431,0.945607325372717,-0.707106781180803,0.325310292159752,0.122410675197973,-0.545324988417288,0.857728609992952,-0.996312612174374,0.932992798826953,-0.680600997789868,0.290284677252220,0.158858143332295,-0.575808191412775,0.876070094187849,-0.998795456196654,0.919113851682304,-0.653172842948365,0.254865659602551,0.195090322014234,-0.605511041398944,0.893224301187728,-0.999924701830523,0.903989293115736,-0.624859488137160,0.219101240155194,0.231058108278444,-0.634393284157955,0.909167983082512,-0.999698818687492,0.887639620395207,-0.595699304487406,0.183039887953764,0.266712757472334,-0.662415777584174,0.923879532503061,-0.998118112891358,0.870086991101138,-0.565731810778798,0.146730474454292,0.302005949316323,-0.689540544730765,0.937339011904143,-0.995184726663340,0.851355193097779,-0.534997619882507,0.110222207293129,0.336889853388972,-0.715730825277215,0.949528180584407,-0.990902635418870,0.831469612295162,-0.503538383721365,0.0735645635992383,0.371317193948243,-0.740951125348058,0.960430519406748,-0.985277642379991,0.810457198245328,-0.471396736821895,0.0368072229412625,0.405241314001047,-0.765167265615265,0.970031253185548,-0.978317370710651,0.788346427619470,-0.438616238534687,2.43971509659118e-13,0.438616238534235,-0.788346427619124,0.978317370710464,-0.970031253185554,0.765167265615468,-0.405241314001423,-0.0368072229407674,0.471396736821355,-0.810457198244830,0.985277642379622,-0.960430519406578,0.740951125348128,-0.371317193948556,-0.0735645635987218,0.503538383720724,-0.831469612294505,0.990902635418316,-0.949528180584065,0.715730825277162,-0.336889853389236,-0.110222207292577,0.534997619881754,-0.851355193096956,0.995184726662600,-0.937339011903634,0.689540544730598,-0.302005949316553,-0.146730474453690,0.565731810777920,-0.870086991100141,0.998118112890432,-0.923879532502391,0.662415777583906,-0.266712757472542,-0.183039887953098,0.595699304486393,-0.887639620394030,0.999698818686379,-0.909167983081688,0.634393284157597,-0.231058108278644,-0.219101240154452,0.624859488136001,-0.903989293114375,0.999924701829226,-0.893224301186757,0.605511041398508,-0.195090322014441,-0.254865659601717,0.653172842947049,-0.919113851680754,0.998795456195173,-0.876070094186739,0.575808191412273,-0.158858143332524,-0.290284677251282,0.680600997788387,-0.932992798825210,0.996312612172713,-0.857728609991712,0.545324988416733,-0.122410675198237,-0.325310292158697,0.707106781179147,-0.945607325370777,0.992479534588593,-0.838224705546401,0.514102744188181,-0.0857973123438279,-0.359895036531034,0.732654271664683,-0.956940335722260,0.987301418147704,-0.817584813143284,0.482183772074368,-0.0490676743271819,-0.393992040056705,0.757208846498430,-0.966976471034711,0.980785280393055,-0.795836904600738,0.449611329650150,-0.0122715382858671,-0.427555093425548,0.780737228563722,-0.975702130028207,0.972939952195378,-0.773010453354761,0.416429560093492,0.0245412285223746,-0.460538710953116,0.803207531471962,-0.983105487420727,0.963776065785267,-0.749136394515669,0.382683432361269,0.0613207363012735,-0.492898192224270,0.824589302776039,-0.989176509954136,0.953306040344046,-0.724247082943877,0.348418680245950,0.0980171403282220,-0.524589682672566,0.844853565240425,-0.993906969991570,0.941544065172915,-0.698376249401600,0.313681740395755,0.134580708505378,-0.555570233013312,0.863972856112018,-0.997290456667776,0.928506080463168,-0.671558954839877,0.278519689382276,0.170961888758139,-0.585797857449764,0.881921264338509,-0.999322384577323,0.914209755693557,-0.643831542882898,0.242980179900857,0.207111376189638,-0.615231590573570,0.898674465683841,-0.999999999988875,0.898674465684072,-0.615231590573996,0.207111376190193,0.242980179900261,-0.643831542882357,0.914209755693161,-0.999322384577142,0.881921264338581,-0.585797857450086,0.170961888758667,0.278519689381625,-0.671558954839210,0.928506080462600,-0.997290456667415,0.863972856111938,-0.555570233013541,0.134580708505892,0.313681740395036,-0.698376249400797,0.941544065172172,-0.993906969991030,0.844853565240200,-0.524589682672715,0.0980171403287366,0.348418680245149,-0.724247082942928,0.953306040343124,-0.989176509953420,0.824589302775677,-0.492898192224351,0.0613207363018029,0.382683432360373,-0.749136394514565,0.963776065784162,-0.983105487419837,0.803207531471473,-0.460538710953142,0.0245412285229329,0.416429560092490,-0.773010453353494,0.972939952194087,-0.975702130027148,0.780737228563116,-0.427555093425533,-0.0122715382852655,0.449611329649028,-0.795836904599300,0.980785280391576,-0.966976471033488,0.757208846497716,-0.393992040056661,-0.0490676743265230,0.482183772073114,-0.817584813141668,0.987301418146038,-0.956940335720878,0.732654271663871,-0.359895036530976,-0.0857973123430980,0.514102744186785,-0.838224705544600,0.992479534586738,-0.945607325369242,0.707106781178250,-0.325310292158638,-0.122410675197422,0.545324988415184,-0.857728609989721,0.996312612170671,-0.932992798823528,0.680600997787416,-0.290284677251237,-0.158858143331610,0.575808191410560,-0.876070094184554,0.998795456192945,-0.919113851678934,0.653172842946016,-0.254865659601700,-0.195090322013415,0.605511041396621,-0.893224301184371,0.999924701826814,-0.903989293112425,0.624859488134919,-0.219101240154477,-0.231058108277492,0.634393284155527,-0.909167983079100,0.999698818683787,-0.887639620391960,0.595699304485276,-0.183039887953181,-0.266712757471251,0.662415777581644,-0.923879532499598,0.998118112887663,-0.870086991097959,0.565731810776781,-0.146730474453844,-0.302005949315111,0.689540544728137,-0.937339011900633,0.995184726659659,-0.851355193094673,0.534997619880605,-0.110222207292818,-0.336889853387631,0.715730825274492,-0.949528180580855,0.990902635415208,-0.831469612292132,0.503538383719582,-0.0735645635990628,-0.371317193946776,0.740951125345245,-0.960430519403159,0.985277642376354,-0.810457198242379,0.471396736820232,-0.0368072229412235,-0.405241313999455,0.765167265612365,-0.970031253181927,0.978317370707043,-0.788346427616607,0.438616238533148,-3.41560113521498e-13,-0.438616238532521,0.788346427616141,-0.978317370706816,0.970031253181981,-0.765167265612693,0.405241314000009,0.0368072229405334,-0.471396736819521,0.810457198241768,-0.985277642375951,0.960430519403044,-0.740951125345446,0.371317193947270,0.0735645635983517,-0.503538383718773,0.831469612291367,-0.990902635414628,0.949528180580574,-0.715730825274576,0.336889853388079,0.110222207292072,-0.534997619879687,0.851355193093748,-0.995184726658900,0.937339011900192,-0.689540544728112,0.302005949315526,0.146730474453049,-0.565731810775742,0.870086991096866,-0.998118112886725,0.923879532499003,-0.662415777581523,0.266712757471647,0.183039887952324,-0.595699304484106,0.887639620390694,-0.999698818682670,0.909167983078357,-0.634393284155320,0.231058108277882,0.219101240153544,-0.624859488133608,0.903989293110981,-0.999924701825519,0.893224301183488,-0.605511041396340,0.195090322013813,0.254865659600677,-0.653172842944553,0.919113851677307,-0.998795456191474,0.876070094183538,-0.575808191410217,0.158858143332031,0.290284677250112,-0.680600997785791,0.932992798821715,-0.996312612169026,0.857728609988581,-0.545324988414793,0.122410675197880,0.325310292157398,-0.707106781176456,0.945607325367239,-0.992479534584924,0.838224705543345,-0.514102744186358,0.0857973123436070,0.359895036529608,-0.732654271661899,0.956940335718683,-0.987301418144059,0.817584813140309,-0.482183772072665,0.0490676743270974,0.393992040055154,-0.757208846495558,0.966976471031100,-0.980785280389437,0.795836904597846,-0.449611329648570,0.0122715382859191,0.427555093423875,-0.780737228560766,0.975702130024567,-0.972939952191793,0.773010453351957,-0.416429560092037,-0.0245412285221860,0.460538710951322,-0.803207531468925,0.983105487417063,-0.963776065781719,0.749136394512955,-0.382683432359940,-0.0613207363009487,0.492898192222357,-0.824589302772926,0.989176509950454,-0.953306040340541,0.724247082941259,-0.348418680244750,-0.0980171403277614,0.524589682670537,-0.844853565237240,0.993906969987873,-0.941544065169456,0.698376249399080,-0.313681740394684,-0.134580708504783,0.555570233011171,-0.863972856108765,0.997290456664071,-0.928506080459761,0.671558954837460,-0.278519689381337,-0.170961888757409,0.585797857447512,-0.881921264335193,0.999322384573613,-0.914209755690207,0.643831542880585,-0.242980179900051,-0.207111376188775,0.615231590571212,-0.898674465680466};
const static double fft_ratio_586_I[1024]={0,0.438616238538521,-0.788346427626583,0.978317370719585,-0.970031253194488,0.765167265622405,-0.405241314004957,-0.0368072229413524,0.471396736825940,-0.810457198252487,0.985277642388798,-0.960430519415414,0.740951125354833,-0.371317193951772,-0.0735645635996472,0.503538383725603,-0.831469612302349,0.990902635427535,-0.949528180592791,0.715730825283627,-0.336889853392130,-0.110222207293842,0.534997619886920,-0.851355193104977,0.995184726671850,-0.937339011912239,0.689540544736814,-0.302005949319120,-0.146730474455292,0.565731810783367,-0.870086991108328,0.998118112899700,-0.923879532510863,0.662415777589865,-0.266712757474780,-0.183039887955035,0.595699304492112,-0.887639620402372,0.999698818695654,-0.909167983090015,0.634393284163290,-0.231058108280549,-0.219101240156721,0.624859488141985,-0.903989293122860,0.999924701838493,-0.893224301194928,0.605511041403928,-0.195090322016011,-0.254865659604316,0.653172842953289,-0.919113851689371,0.998795456204421,-0.876070094194744,0.575808191417412,-0.158858143333756,-0.290284677254206,0.680600997794875,-0.932992798833947,0.996312612181929,-0.857728609999538,0.545324988421584,-0.122410675199130,-0.325310292161943,0.707106781185875,-0.945607325379623,0.992479534597764,-0.838224705554039,0.514102744192738,-0.0857973123443803,-0.359895036534598,0.732654271671641,-0.956940335731203,0.987301418156819,-0.817584813150724,0.482183772078624,-0.0490676743273931,-0.393992040060582,0.757208846505610,-0.966976471043738,0.980785280402100,-0.795836904607968,0.449611329654100,-0.0122715382857369,-0.427555093429733,0.780737228571113,-0.975702130037306,0.972939952204342,-0.773010453361773,0.416429560097131,0.0245412285228460,-0.460538710957602,0.803207531479554,-0.983105487429886,0.963776065794137,-0.749136394522452,0.382683432364591,0.0613207363020855,-0.492898192229052,0.824589302783822,-0.989176509963342,0.953306040352811,-0.724247082950424,0.348418680248952,0.0980171403293735,-0.524589682677637,0.844853565248388,-0.993906970000811,0.941544065181562,-0.698376249407900,0.313681740398432,0.134580708506868,-0.555570233018665,0.863972856120151,-0.997290456677040,0.928506080471685,-0.671558954845923,0.278519689384624,0.170961888759965,-0.585797857455392,0.881921264346800,-0.999322384586596,0.914209755701934,-0.643831542888680,0.242980179902873,0.207111376191797,-0.615231590579466,0.898674465692280,-0.999999999998146,0.898674465692296,-0.615231590579507,0.207111376191874,0.242980179902750,-0.643831542888512,0.914209755701735,-0.999322384586397,0.881921264346642,-0.585797857455319,0.170961888760011,0.278519689384441,-0.671558954845617,0.928506080471299,-0.997290456676643,0.863972856119825,-0.555570233018489,0.134580708506898,0.313681740398175,-0.698376249407446,0.941544065180983,-0.993906970000217,0.844853565247902,-0.524589682677371,0.0980171403294025,0.348418680248608,-0.724247082949811,0.953306040352036,-0.989176509962554,0.824589302783184,-0.492898192228708,0.0613207363021279,0.382683432364146,-0.749136394521672,0.963776065793162,-0.983105487428907,0.803207531478774,-0.460538710957195,0.0245412285229165,0.416429560096572,-0.773010453360815,0.972939952203163,-0.975702130036140,0.780737228570201,-0.427555093429276,-0.0122715382856232,0.449611329653414,-0.795836904606826,0.980785280400717,-0.966976471042390,0.757208846504576,-0.393992040060089,-0.0490676743272215,0.482183772077798,-0.817584813149388,0.987301418155230,-0.956940335729679,0.732654271670498,-0.359895036534085,-0.0857973123441364,0.514102744191760,-0.838224705552504,0.992479534595970,-0.945607325377929,0.707106781184633,-0.325310292161423,-0.122410675198799,0.545324988420444,-0.857728609997798,0.996312612179928,-0.932992798832090,0.680600997793547,-0.290284677253694,-0.158858143333323,0.575808191416097,-0.876070094192793,0.998795456202217,-0.919113851687359,0.653172842951887,-0.254865659603827,-0.195090322015463,0.605511041402429,-0.893224301192762,0.999924701836087,-0.903989293120702,0.624859488140522,-0.219101240156270,-0.231058108279872,0.634393284161597,-0.909167983087630,0.999698818693049,-0.887639620400077,0.595699304490602,-0.183039887954638,-0.266712757473959,0.662415777587968,-0.923879532508256,0.998118112896901,-0.870086991105905,0.565731810781824,-0.146730474454963,-0.302005949318143,0.689540544734706,-0.937339011909408,0.995184726668861,-0.851355193102438,0.534997619885359,-0.110222207293597,-0.336889853390984,0.715730825281298,-0.949528180589735,0.990902635424362,-0.831469612299705,0.503538383724039,-0.0735645635995015,-0.371317193950445,0.740951125352278,-0.960430519412131,0.985277642385446,-0.810457198249750,0.471396736824388,-0.0368072229413210,-0.405241314003435,0.765167265619615,-0.970031253190980,0.978317370716062,-0.788346427623765,0.438616238536995,-9.75886038641900e-14,-0.438616238536807,0.788346427623600,-0.978317370715937,0.970031253190915,-0.765167265619630,0.405241314003543,0.0368072229411184,-0.471396736824106,0.810457198249424,-0.985277642385128,0.960430519411880,-0.740951125352151,0.371317193950486,0.0735645635992771,-0.503538383723652,0.831469612299211,-0.990902635423848,0.949528180589301,-0.715730825281041,0.336889853390972,0.110222207293336,-0.534997619884853,0.851355193101769,-0.995184726668150,0.937339011908797,-0.689540544734328,0.302005949318093,0.146730474454651,-0.565731810781188,0.870086991105053,-0.998118112895993,0.923879532507474,-0.662415777587481,0.266712757473885,0.183039887954260,-0.595699304489824,0.887639620399035,-0.999698818691944,0.909167983086684,-0.634393284161013,0.231058108279787,0.219101240155813,-0.624859488139591,0.903989293119466,-0.999924701834786,0.893224301191659,-0.605511041401760,0.195090322015383,0.254865659603276,-0.653172842950793,0.919113851685924,-0.998795456200722,0.876070094191542,-0.575808191415356,0.158858143333263,0.290284677253037,-0.680600997792280,0.932992798830452,-0.996312612178242,0.857728609996408,-0.545324988419644,0.122410675198773,0.325310292160645,-0.707106781183184,0.945607325376084,-0.992479534594096,0.838224705550983,-0.514102744190915,0.0857973123441593,0.359895036533173,-0.732654271668858,0.956940335727626,-0.987301418153173,0.817584813147748,-0.482183772076921,0.0490676743273086,0.393992040059031,-0.757208846502738,0.966976471040127,-0.980785280398482,0.795836904605076,-0.449611329652520,0.0122715382857890,0.427555093428059,-0.780737228568157,0.975702130033666,-0.972939952200756,0.773010453358968,-0.416429560095676,-0.0245412285226574,0.460538710955808,-0.803207531476517,0.983105487426222,-0.963776065790589,0.749136394519739,-0.382683432363262,-0.0613207363017607,0.492898192227139,-0.824589302780709,0.989176509959660,-0.953306040349305,0.724247082947805,-0.348418680247751,-0.0980171403289129,0.524589682675609,-0.844853565245203,0.993906969997115,-0.941544065178103,0.698376249405380,-0.313681740397361,-0.134580708506272,0.555570233016524,-0.863972856116898,0.997290456673335,-0.928506080468278,0.671558954843505,-0.278519689383685,-0.170961888759235,0.585797857453141,-0.881921264343484,0.999322384582887,-0.914209755698583,0.643831542886367,-0.242980179902067,-0.207111376190933,0.615231590577108,-0.898674465688904,0.999999999994437,-0.898674465689006,0.615231590577303,-0.207111376191202,-0.242980179901755,0.643831542886050,-0.914209755698306,0.999322384582695,-0.881921264343418,0.585797857453225,-0.170961888759474,-0.278519689383315,0.671558954843054,-0.928506080467820,0.997290456672952,-0.863972856116670,0.555570233016510,-0.134580708506496,-0.313681740396919,0.698376249404786,-0.941544065177459,0.993906969996542,-0.844853565244821,0.524589682675508,-0.0980171403291361,-0.348418680247224,0.724247082947058,-0.953306040348471,0.989176509958900,-0.824589302780181,0.492898192226965,-0.0613207363019979,-0.382683432362637,0.749136394518829,-0.963776065789562,0.983105487425279,-0.803207531475853,0.460538710955574,-0.0245412285229231,-0.416429560094939,0.773010453357886,-0.972939952199533,0.975702130032543,-0.780737228567367,0.427555093427779,0.0122715382854801,-0.449611329651660,0.795836904603815,-0.980785280397061,0.966976471038829,-0.757208846501832,0.393992040058718,0.0490676743269421,-0.482183772075924,0.817584813146300,-0.987301418151553,0.956940335726158,-0.732654271667847,0.359895036532841,0.0857973123437211,-0.514102744189770,0.838224705549342,-0.992479534592277,0.945607325374454,-0.707106781182080,0.325310292160309,0.122410675198248,-0.545324988418340,0.857728609994567,-0.996312612176225,0.932992798828665,-0.680600997791094,0.290284677252711,0.158858143332638,-0.575808191413882,0.876070094189497,-0.998795456198508,0.919113851683989,-0.653172842949539,0.254865659602976,0.195090322014644,-0.605511041400106,0.893224301189406,-0.999924701832378,0.903989293117391,-0.624859488138281,0.219101240155553,0.231058108278920,-0.634393284159169,0.909167983084218,-0.999698818689345,0.887639620396830,-0.595699304488472,0.183039887954055,0.266712757472876,-0.662415777585439,0.923879532504793,-0.998118112893206,0.870086991102727,-0.565731810779807,0.146730474454516,0.302005949316930,-0.689540544732078,0.937339011905898,-0.995184726665180,0.851355193099332,-0.534997619883458,0.110222207293285,0.336889853389642,-0.715730825278576,0.949528180586183,-0.990902635420700,0.831469612296676,-0.503538383722256,0.0735645635993260,0.371317193948977,-0.740951125349465,0.960430519408542,-0.985277642381809,0.810457198246802,-0.471396736822726,0.0368072229412820,0.405241314001843,-0.765167265616715,0.970031253187359,-0.978317370712454,0.788346427620902,-0.438616238535456,1.95177207727656e-13,0.438616238535092,-0.788346427620616,0.978317370712289,-0.970031253187341,0.765167265616855,-0.405241314002130,-0.0368072229408844,0.471396736822272,-0.810457198246362,0.985277642381457,-0.960430519408345,0.740951125349469,-0.371317193949200,-0.0735645635989069,0.503538383721700,-0.831469612296074,0.990902635420160,-0.949528180585810,0.715730825278455,-0.336889853389815,-0.110222207292830,0.534997619882787,-0.851355193098560,0.995184726664450,-0.937339011905355,0.689540544731842,-0.302005949317066,-0.146730474454010,0.565731810779010,-0.870086991101778,0.998118112892286,-0.923879532504086,0.662415777585098,-0.266712757472990,-0.183039887953486,0.595699304487537,-0.887639620395699,0.999698818688234,-0.909167983083353,0.634393284158735,-0.231058108279025,-0.219101240154905,0.624859488137198,-0.903989293116072,0.999924701831079,-0.893224301188391,0.605511041399592,-0.195090322014755,-0.254865659602237,0.653172842948297,-0.919113851682477,0.998795456197023,-0.876070094188340,0.575808191413301,-0.158858143332770,-0.290284677251867,0.680600997789684,-0.932992798826957,0.996312612174556,-0.857728609993277,0.545324988417703,-0.122410675198416,-0.325310292159346,0.707106781180492,-0.945607325372546,0.992479534590427,-0.838224705547928,0.514102744189092,-0.0857973123439384,-0.359895036531747,0.732654271666074,-0.956940335724049,0.987301418149527,-0.817584813144772,0.482183772075219,-0.0490676743272241,-0.393992040057480,0.757208846499866,-0.966976471036516,0.980785280394864,-0.795836904602184,0.449611329650940,-0.0122715382858410,-0.427555093426385,0.780737228565200,-0.975702130030027,0.972939952197171,-0.773010453356164,0.416429560094220,0.0245412285224689,-0.460538710954013,0.803207531473480,-0.983105487422558,0.963776065787041,-0.749136394517026,0.382683432361933,0.0613207363014359,-0.492898192225226,0.824589302777595,-0.989176509955977,0.953306040345799,-0.724247082945187,0.348418680246550,0.0980171403284523,-0.524589682673580,0.844853565242018,-0.993906969993418,0.941544065174644,-0.698376249402860,0.313681740396290,0.134580708505676,-0.555570233014383,0.863972856113645,-0.997290456669629,0.928506080464871,-0.671558954841087,0.278519689382746,0.170961888758504,-0.585797857450889,0.881921264340167,-0.999322384579177,0.914209755695232,-0.643831542884055,0.242980179901261,0.207111376190070,-0.615231590574749,0.898674465685529,-0.999999999990729,0.898674465685716,-0.615231590575098,0.207111376190529,0.242980179900759,-0.643831542883588,0.914209755694876,-0.999322384578993,0.881921264340193,-0.585797857451132,0.170961888758936,0.278519689382188,-0.671558954840491,0.928506080464340,-0.997290456669261,0.863972856113515,-0.555570233014531,0.134580708506094,0.313681740395663,-0.698376249402126,0.941544065173934,-0.993906969992867,0.844853565241740,-0.524589682673646,0.0980171403288698,0.348418680245841,-0.724247082944305,0.953306040344906,-0.989176509955247,0.824589302777179,-0.492898192225222,0.0613207363018679,0.382683432361128,-0.749136394515986,0.963776065785961,-0.983105487421651,0.803207531472933,-0.460538710953953,0.0245412285229296,0.416429560093306,-0.773010453354958,0.972939952195902,-0.975702130028946,0.780737228564533,-0.427555093426282,-0.0122715382853371,0.449611329649905,-0.795836904600805,0.980785280393405,-0.966976471035268,0.757208846499088,-0.393992040057347,-0.0490676743266627,0.482183772074051,-0.817584813143212,0.987301418147877,-0.956940335722638,0.732654271665196,-0.359895036531598,-0.0857973123433057,0.514102744187780,-0.838224705546181,0.992479534588585,-0.945607325370979,0.707106781179526,-0.325310292159195,-0.122410675197697,0.545324988416236,-0.857728609991336,0.996312612172522,-0.932992798825241,0.680600997788642,-0.290284677251728,-0.158858143331952,0.575808191411667,-0.876070094186202,0.998795456194800,-0.919113851680619,0.653172842947191,-0.254865659602125,-0.195090322013824,0.605511041397783,-0.893224301186050,0.999924701828669,-0.903989293114081,0.624859488136040,-0.219101240154836,-0.231058108277968,0.634393284156741,-0.909167983080806,0.999698818685640,-0.887639620393583,0.595699304486341,-0.183039887953472,-0.266712757471793,0.662415777582909,-0.923879532501329,0.998118112889510,-0.870086991099548,0.565731810777789,-0.146730474454068,-0.302005949315717,0.689540544729451,-0.937339011902388,0.995184726661499,-0.851355193096226,0.534997619881556,-0.110222207292973,-0.336889853388301,0.715730825275854,-0.949528180582631,0.990902635417039,-0.831469612293647,0.503538383720473,-0.0735645635991506,-0.371317193947509,0.740951125346651,-0.960430519404954,0.985277642378172,-0.810457198243853,0.471396736821064,-0.0368072229412430,-0.405241314000251,0.765167265613815,-0.970031253183738,0.978317370708847,-0.788346427618038,0.438616238533917,-2.92765811590399e-13,-0.438616238533378,0.788346427617632,-0.978317370708640,0.970031253183768,-0.765167265614081,0.405241314000716,0.0368072229406504,-0.471396736820438,0.810457198243299,-0.985277642377787,0.960430519404811,-0.740951125346787,0.371317193947913,0.0735645635985368,-0.503538383719748,0.831469612292936,-0.990902635416472,0.949528180582320,-0.715730825275869,0.336889853388657,0.110222207292324,-0.534997619880720,0.851355193095352,-0.995184726660750,0.937339011901913,-0.689540544729355,0.302005949316039,0.146730474453370,-0.565731810776831,0.870086991098504,-0.998118112888578,0.923879532500697,-0.662415777582714,0.266712757472095,0.183039887952711,-0.595699304485249,0.887639620392362,-0.999698818684525,0.909167983080022,-0.634393284156458,0.231058108278263,0.219101240153998,-0.624859488134804,0.903989293112678,-0.999924701827372,0.893224301185122,-0.605511041397424,0.195090322014127,0.254865659601197,-0.653172842945801,0.919113851679031,-0.998795456193324,0.876070094185139,-0.575808191411245,0.158858143332277,0.290284677250697,-0.680600997787089,0.932992798823462,-0.996312612170870,0.857728609990146,-0.545324988415763,0.122410675198058,0.325310292158047,-0.707106781177801,0.945607325369007,-0.992479534586759,0.838224705544873,-0.514102744187269,0.0857973123437174,0.359895036530321,-0.732654271663291,0.956940335720472,-0.987301418145882,0.817584813141796,-0.482183772073516,0.0490676743271396,0.393992040055929,-0.757208846496994,0.966976471032906,-0.980785280391246,0.795836904599292,-0.449611329649360,0.0122715382858931,0.427555093424712,-0.780737228562244,0.975702130026387,-0.972939952193585,0.773010453353359,-0.416429560092765,-0.0245412285222803,0.460538710952219,-0.803207531470443,0.983105487418895,-0.963776065783493,0.749136394514312,-0.382683432360605,-0.0613207363011111,0.492898192223314,-0.824589302774482,0.989176509952295,-0.953306040342294,0.724247082942568,-0.348418680245350,-0.0980171403279917,0.524589682671552,-0.844853565238833,0.993906969989722,-0.941544065171185,0.698376249400340,-0.313681740395220,-0.134580708505081,0.555570233012241,-0.863972856110392,0.997290456665924,-0.928506080461464,0.671558954838668,-0.278519689381807,-0.170961888757774,0.585797857448638,-0.881921264336851,0.999322384575468,-0.914209755691882,0.643831542881742,-0.242980179900454,-0.207111376189206,0.615231590572391,-0.898674465682153,0.999999999987021,-0.898674465682427,0.615231590572894,-0.207111376189857,-0.242980179899763,0.643831542881126,-0.914209755691446,0.999322384575290,-0.881921264336969,0.585797857449039,-0.170961888758398,-0.278519689381062,0.671558954837929,-0.928506080460861,0.997290456665569,-0.863972856110360,0.555570233012552,-0.134580708505691,-0.313681740394408,0.698376249399467,-0.941544065170410,0.993906969989192,-0.844853565238659,0.524589682671784,-0.0980171403286034,-0.348418680244457,0.724247082941552,-0.953306040341342,0.989176509951593,-0.824589302774176,0.492898192223480,-0.0613207363017379,-0.382683432359619,0.749136394513143,-0.963776065782362,0.983105487418023,-0.803207531470013,0.460538710952332,-0.0245412285229362,-0.416429560091673,0.773010453352030,-0.972939952192272,0.975702130025349,-0.780737228561699,0.427555093424784,0.0122715382851940,-0.449611329648151,0.795836904597795,-0.980785280389748,0.966976471031707,-0.757208846496344,0.393992040055975,0.0490676743263832,-0.482183772072177,0.817584813140124,-0.987301418144200,0.956940335719118,-0.732654271662546,0.359895036530354,0.0857973123428903,-0.514102744185790,0.838224705543019,-0.992479534584892,0.945607325367504,-0.707106781176973,0.325310292158081,0.122410675197146,-0.545324988414132,0.857728609988105,-0.996312612168819,0.932992798821816,-0.680600997786189,0.290284677250745,0.158858143331267,-0.575808191409452,0.876070094182906,-0.998795456191091,0.919113851677249,-0.653172842944842,0.254865659601274,0.195090322013005,-0.605511041395460,0.893224301182693,-0.999924701824960,0.903989293110770,-0.624859488133799,0.219101240154118,0.231058108277016,-0.634393284154313,0.909167983077394,-0.999698818681935,0.887639620390336,-0.595699304484210,0.183039887952889,0.266712757470710,-0.662415777580380,0.923879532497866,-0.998118112885815,0.870086991096370,-0.565731810775772,0.146730474453620,0.302005949314504,-0.689540544726823,0.937339011898878,-0.995184726657818,0.851355193093121,-0.534997619879655,0.110222207292662,0.336889853386960,-0.715730825273131,0.949528180579079,-0.990902635413377,0.831469612290618,-0.503538383718690,0.0735645635989751,0.371317193946042,-0.740951125343838,0.960430519401365,-0.985277642374535,0.810457198240905,-0.471396736819401,0.0368072229412040,0.405241313998659,-0.765167265610914,0.970031253180117,-0.978317370705239,0.788346427615175,-0.438616238532378};
/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
void PeriphCommonClock_Config(void);
/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */

/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

/* Configure the peripherals common clocks */
  PeriphCommonClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_DMA_Init();
  MX_ADC1_Init();
  MX_DFSDM1_Init();
  MX_I2C2_Init();
  MX_QUADSPI_Init();
  MX_SPI3_Init();
  MX_USART1_UART_Init();
  MX_USART3_UART_Init();
  MX_USB_OTG_FS_PCD_Init();
  MX_TIM1_Init();
  MX_ADC2_Init();
  /* USER CODE BEGIN 2 */
  HAL_ADC_Start_DMA(&hadc2, (uint32_t*)adc2_buf, ADC_BUF_LEN);
  HAL_ADC_Start_DMA(&hadc1, (uint32_t*)adc1_buf, ADC_BUF_LEN);

  HAL_TIM_Base_Start_IT(&htim1);
  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
#define RUNNING_SUM_LENGTH (10)
  double running_sum[RUNNING_SUM_LENGTH];
  int i=0;
  while (1)
  {
      if(adc_conv_flag == 0x03){
          double phase_585 = phase1_585 - phase2_585;
          double phase_586 = phase1_586 - phase2_586;
          //if (phase_585<0) phase_585+=3.141592653589;
          //if (phase_586<0) phase_586+=3.141592653589;
          double temp = (phase_585*6+phase_586)/7;
          if (temp<0) temp+=3.141592653589;
          running_sum[i] = temp;
          i = (i+1)%10;
          double average_shif=0;
          for(int j=0;j<RUNNING_SUM_LENGTH;j++)
          {
              average_shif+=running_sum[j];
          }
          average_shif /=10;
          uint8_t distance[10];
          snprintf(distance,10,"%lf\r\n",average_shif);
          HAL_UART_Transmit(&huart1,distance,7,10);
          adc_conv_flag=0;
      }
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */
  }
  /* USER CODE END 3 */
}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct = {0};
  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};

  /** Configure the main internal regulator output voltage
  */
  if (HAL_PWREx_ControlVoltageScaling(PWR_REGULATOR_VOLTAGE_SCALE1) != HAL_OK)
  {
    Error_Handler();
  }
  /** Configure LSE Drive Capability
  */
  HAL_PWR_EnableBkUpAccess();
  __HAL_RCC_LSEDRIVE_CONFIG(RCC_LSEDRIVE_LOW);
  /** Initializes the RCC Oscillators according to the specified parameters
  * in the RCC_OscInitTypeDef structure.
  */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_LSE|RCC_OSCILLATORTYPE_MSI;
  RCC_OscInitStruct.LSEState = RCC_LSE_ON;
  RCC_OscInitStruct.MSIState = RCC_MSI_ON;
  RCC_OscInitStruct.MSICalibrationValue = 0;
  RCC_OscInitStruct.MSIClockRange = RCC_MSIRANGE_6;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_MSI;
  RCC_OscInitStruct.PLL.PLLM = 1;
  RCC_OscInitStruct.PLL.PLLN = 77;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV7;
  RCC_OscInitStruct.PLL.PLLQ = RCC_PLLQ_DIV2;
  RCC_OscInitStruct.PLL.PLLR = RCC_PLLR_DIV4;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    Error_Handler();
  }
  /** Initializes the CPU, AHB and APB buses clocks
  */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_4) != HAL_OK)
  {
    Error_Handler();
  }
  /** Enable MSI Auto calibration
  */
  HAL_RCCEx_EnableMSIPLLMode();
}

/**
  * @brief Peripherals Common Clock Configuration
  * @retval None
  */
void PeriphCommonClock_Config(void)
{
  RCC_PeriphCLKInitTypeDef PeriphClkInit = {0};

  /** Initializes the peripherals clock
  */
  PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_USB|RCC_PERIPHCLK_ADC;
  PeriphClkInit.AdcClockSelection = RCC_ADCCLKSOURCE_PLLSAI1;
  PeriphClkInit.UsbClockSelection = RCC_USBCLKSOURCE_PLLSAI1;
  PeriphClkInit.PLLSAI1.PLLSAI1Source = RCC_PLLSOURCE_MSI;
  PeriphClkInit.PLLSAI1.PLLSAI1M = 1;
  PeriphClkInit.PLLSAI1.PLLSAI1N = 24;
  PeriphClkInit.PLLSAI1.PLLSAI1P = RCC_PLLP_DIV7;
  PeriphClkInit.PLLSAI1.PLLSAI1Q = RCC_PLLQ_DIV2;
  PeriphClkInit.PLLSAI1.PLLSAI1R = RCC_PLLR_DIV2;
  PeriphClkInit.PLLSAI1.PLLSAI1ClockOut = RCC_PLLSAI1_48M2CLK|RCC_PLLSAI1_ADC1CLK;
  if (HAL_RCCEx_PeriphCLKConfig(&PeriphClkInit) != HAL_OK)
  {
    Error_Handler();
  }
}

/* USER CODE BEGIN 4 */
//fft
void fft(int order,ADC_HandleTypeDef* hadc)
{
    double sum_585_r=0;
    double sum_585_i=0;
    double sum_586_r=0;
    double sum_586_i=0;
    if(hadc == &hadc1 && ((adc_conv_flag & 0x01) !=0x01)){
        for (int i = 0; i < 1024; i++) {
            sum_585_r += adc1_buf[i + order * 1024] * fft_ratio_585_R[i];
            sum_585_i += adc1_buf[i + order * 1024] * fft_ratio_585_I[i];
            sum_586_r += adc1_buf[i + order * 1024] * fft_ratio_586_R[i];
            sum_586_i += adc1_buf[i + order * 1024] * fft_ratio_586_I[i];
        }
        phase1_585 = atan(sum_585_i/sum_585_r);
        phase1_586 = atan(sum_586_i/sum_586_r);
        adc_conv_flag = adc_conv_flag | 0x01;
    } else if (hadc == &hadc2 && ((adc_conv_flag & 0x02) !=0x02)) {
        for (int i = 0; i < 1024; i++) {
            sum_585_r += adc2_buf[i + order * 1024] * fft_ratio_585_R[i];
            sum_585_i += adc2_buf[i + order * 1024] * fft_ratio_585_I[i];
            sum_586_r += adc2_buf[i + order * 1024] * fft_ratio_586_R[i];
            sum_586_i += adc2_buf[i + order * 1024] * fft_ratio_586_I[i];
        }
        phase2_585 = atan(sum_585_i/sum_585_r);
        phase2_586 = atan(sum_586_i/sum_586_r);
        adc_conv_flag = adc_conv_flag | 0x02;
    }
}

// Called when first half of buffer is filled
void HAL_ADC_ConvHalfCpltCallback(ADC_HandleTypeDef* hadc) {
    fft(0,hadc);
    if(hadc == &hadc1){
        //HAL_UART_Transmit(&huart1,"half\r\n",6,10);
    }
}

// Called when buffer is completely filled
void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc) {
    fft(1,hadc);
    if(hadc == &hadc1){
        HAL_GPIO_TogglePin(GPIOB,GPIO_PIN_2);
        //HAL_UART_Transmit(&huart1,"full\r\n",10,10);
    }
}
/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @retval None
  */
void Error_Handler(void)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  __disable_irq();
  while (1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t *file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */

/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
